<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Imaging Screen</title>
    <link rel="stylesheet" href="style.css">
</head>
<body class="imaging-only">
    <header class="rt-header">
        <a href="index.html" class="back-link" title="Return to the schedule">&larr; Back</a>

        <div class="header-center">
            <h1 id="imaging-patient-title">Imaging – Loading…</h1>
            <div class="header-meta">
                <span class="meta-pill" id="emulator-version-pill" title="Emulator build/version"></span>
                <span class="meta-pill" id="study-mode-pill" title="Current mode"></span>
            </div>
        </div>

        <div class="header-actions">
            <button id="open-chart-btn" class="btn btn-secondary" type="button" title="Open the Patient Chart screen for this same patient file in a new tab/window">
                Open Chart Screen
            </button>
        </div>
    </header>

    <main class="imaging-container">
        <div class="imaging-grid">
            <!-- Controls panel -->
            <div class="controls-column">
                <div class="control-group">
                    <div class="control-title">Opacity / Fusion</div>
                    <label class="control-label" for="overlay-opacity">Overlay Opacity</label>
                    <input type="range" id="overlay-opacity" class="slider" min="0" max="1" step="0.05" value="0.5">
                </div>

                <div class="control-group">
                    <div class="control-title">Couch Shifts (cm)</div>

                    <div class="axis-grid">
                        <div class="axis-label">VRT</div>
                        <div class="axis-buttons">
                            <button class="control-btn" data-axis="y" data-delta="0.1">▲</button>
                            <button class="control-btn" data-axis="y" data-delta="-0.1">▼</button>
                        </div>
                        <input type="number" class="axis-input" id="shift-y" value="0.0" step="0.1">

                        <div class="axis-label">LAT</div>
                        <div class="axis-buttons">
                            <button class="control-btn" data-axis="x" data-delta="-0.1">◀</button>
                            <button class="control-btn" data-axis="x" data-delta="0.1">▶</button>
                        </div>
                        <input type="number" class="axis-input" id="shift-x" value="0.0" step="0.1">

                        <div class="axis-label">LNG</div>
                        <div class="axis-buttons">
                            <button class="control-btn" data-axis="z" data-delta="-0.1">▼</button>
                            <button class="control-btn" data-axis="z" data-delta="0.1">▲</button>
                        </div>
                        <input type="number" class="axis-input" id="shift-z" value="0.0" step="0.1">
                    </div>
                </div>

                <div class="control-group">
                    <div class="control-title">Rotation (°)</div>
                    <div class="axis-grid">
                        <div class="axis-label">PITCH</div>
                        <div class="axis-buttons">
                            <button class="control-btn" data-axis="pitch" data-delta="0.1">⟲</button>
                            <button class="control-btn" data-axis="pitch" data-delta="-0.1">⟳</button>
                        </div>
                        <input type="number" class="axis-input" id="shift-pitch" value="0.0" step="0.1">
                    </div>
                </div>

                <div class="action-buttons">
                    <button class="control-btn-action" id="reset-shifts">Reset</button>
                    <button class="control-btn-action" id="apply-shifts">Apply Shifts</button>
                </div>

                <div class="imaging-meta">
                    <div><strong>Expected imaging:</strong> <span id="expected-imaging">—</span></div>
                    <div><strong>Notes:</strong> <span id="imaging-notes">—</span></div>
                </div>
            </div>

            <!-- Viewer panel -->
            <div class="viewer-column">
                <div class="viewer-title">Image Guided Alignment</div>
                <div class="image-viewer">
                    <img id="drr-image" src="" alt="DRR/Planning reference">
                    <img id="overlay-image" src="" alt="On-board imaging overlay">
                </div>
            </div>
        </div>
    </main>

    <script src="study_config.js"></script>
    <script src="imaging.js"></script>
</body>
</html>
